### 11. Responda y justifique los siguientes ejercicios.

<b>a.</b> En la VM, utilice el comando dig para obtener la dirección IP del host ```www.redes.unlp.edu.ar``` y responda:

```bash
redes@debian:~$ dig www.redes.unlp.edu.ar

; <<>> DiG 9.16.27-Debian <<>> www.redes.unlp.edu.ar
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 8607
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1232
; COOKIE: 9dca5537bb557fe70100000067fd84650ac939d876faaa2c (good)
;; QUESTION SECTION:
;www.redes.unlp.edu.ar.		IN	A

;; ANSWER SECTION:
www.redes.unlp.edu.ar.	300	IN	A	172.28.0.50

;; Query time: 0 msec
;; SERVER: 172.28.0.29#53(172.28.0.29)
;; WHEN: Mon Apr 14 18:55:49 -03 2025
;; MSG SIZE  rcvd: 94
```

<b>i.</b> ¿La solicitud fue recursiva? ¿Y la respuesta? ¿Cómo lo sabe?

La solicitud fue recursiva ya que se encuentra la flag ```rd``` (recursion desired). El cliente (en este caso, dig) solicitó al servidor DNS que realizar una consulta recursiva.

La respuesta fue recusriva ya que se encuentra la flag ```ra``` (recursion available). El servidor DNS al que se consultó soporta consultas recursivas y probablemente realizó la búsqueda en nombre del cliente para encontis rar la respuesta.

<b>ii.</b> ¿Puede indicar si se trata de una respuesta autoritativa? ¿Qué significa que lo sea?

No se trata de una respuesta autoritativa por la ausencia de la flag ```aa``` (authoritative answer).

Que una respuesta sea autoritativa significa que el servidor DNS que proporcionó la respuesta tiene autoridad directa sobre la zona para el nombre consultado. Esto quiere decir que el servidor consultado es uno de los servidores DNS primarios o secundarios configurados para esa zona y contiene la información original y actualizada del registro DNS solicitado.
En una respuesta no autoritativa, el servidor consultado obtuvo la información de otro servidor a través de una consulta recursiva o de su caché.

<b>iii.</b> ¿Cuál es la dirección IP del resolver utilizado? ¿Cómo lo sabe?

La dirección IP del resolver utilizado es ```172.28.0.29```. Esto se indica en la sección ```SERVER``` de la salida del dig:

```;; SERVER: 172.28.0.29#53(172.28.0.29)```

Esta línea muestra la dirección IP del servidor DNS al que dig envió la consulta (172.28.0.29) y el puerto que utilizó (53, que es el puerto estándar para las consultas DNS).

<b>b.</b> ¿Cuáles son los servidores de correo del dominio ```redes.unlp.edu.ar```? ¿Por qué hay más de uno y qué significan los números que aparecen entre MX y el nombre? Si se quiere enviar un correo destinado a ```redes.unlp.edu.ar```, ¿a qué servidor se le entregará? ¿En qué situación se le entregará al otro?

```bash
redes@debian:~$ dig redes.unlp.edu.ar MX

; <<>> DiG 9.16.27-Debian <<>> redes.unlp.edu.ar MX
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 2411
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 3

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1232
; COOKIE: 3c42aade506561910100000067fe815696776306768cb0d7 (good)
;; QUESTION SECTION:
;redes.unlp.edu.ar.		IN	MX

;; ANSWER SECTION:
redes.unlp.edu.ar.	86400	IN	MX	5 mail.redes.unlp.edu.ar.
redes.unlp.edu.ar.	86400	IN	MX	10 mail2.redes.unlp.edu.ar.

;; ADDITIONAL SECTION:
mail.redes.unlp.edu.ar.	86400	IN	A	172.28.0.90
mail2.redes.unlp.edu.ar. 86400	IN	A	172.28.0.91

;; Query time: 4 msec
;; SERVER: 172.28.0.29#53(172.28.0.29)
;; WHEN: Tue Apr 15 12:55:02 -03 2025
;; MSG SIZE  rcvd: 149
```

Los servidores de correo del dominio ```redes.unlp.edu.ar``` son:
- ```mail.redes.unlp.edu.ar```
- ```mail2.redes.unlp.edu.ar```

Hay más de un servidor de correo para proporcionar redudancia y balanceo de carga. Si un servidor de correo falla o está sobrecargado, los correos pueden ser entregados al otro servidor.

Los números que aparecen entre ```MX``` y el nombre del servidor (5 y 10) son los valores de prioridad. Estos números indican la preferencia con la que los servidores de correo deben ser utilizados para la entrega de correo electrónico. A más bajo el valor, mayor la prioridad.

Si se envía un correo electrónico a ```redes.unlp.edu.ar```, se intentará enviar primero al servidor con prioridad más alta (es decir, le número más bajo), que es ```mail.redes.unlp.edu.ar```.

En caso de que este servidor no responda o no esté disponible, se intentará entregar al siguiente servidor con priodad más alta, que sería ```mail2.redes.unlp.edu.ar```. Permitiendo que haya una mayor probabilidad de que el correo sea entregado incluso si uno de los servidores de correo falla.

<b>c.</b> ¿Cuáles son los servidores de DNS del dominio ```redes.unlp.edu.ar```?

```bash
redes@debian:~$ dig redes.unlp.edu.ar NS

; <<>> DiG 9.16.27-Debian <<>> redes.unlp.edu.ar NS
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 16594
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 3

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1232
; COOKIE: bb4a12212a9cf51e0100000067feb3c15e79f2d54f87ed98 (good)
;; QUESTION SECTION:
;redes.unlp.edu.ar.		IN	NS

;; ANSWER SECTION:
redes.unlp.edu.ar.	86400	IN	NS	ns-sv-b.redes.unlp.edu.ar.
redes.unlp.edu.ar.	86400	IN	NS	ns-sv-a.redes.unlp.edu.ar.

;; ADDITIONAL SECTION:
ns-sv-a.redes.unlp.edu.ar. 604800 IN	A	172.28.0.30
ns-sv-b.redes.unlp.edu.ar. 604800 IN	A	172.28.0.29

;; Query time: 8 msec
;; SERVER: 172.28.0.29#53(172.28.0.29)
;; WHEN: Tue Apr 15 16:30:09 -03 2025
;; MSG SIZE  rcvd: 150
```

Sería lo que se encuentra en ANSWER SECTION?

<b>d.</b> Repita la consulta anterior cuatro veces más. ¿Qué observa? ¿Puede explicar a qué se debe?

```bash
redes@debian:~$ dig redes.unlp.edu.ar NS

; <<>> DiG 9.16.27-Debian <<>> redes.unlp.edu.ar NS
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 11313
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 3

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 1232
; COOKIE: 780582b94644e9890100000067feb444de6dee1f7c0c2a52 (good)
;; QUESTION SECTION:
;redes.unlp.edu.ar.		IN	NS

;; ANSWER SECTION:
redes.unlp.edu.ar.	86400	IN	NS	ns-sv-b.redes.unlp.edu.ar.
redes.unlp.edu.ar.	86400	IN	NS	ns-sv-a.redes.unlp.edu.ar.

;; ADDITIONAL SECTION:
ns-sv-a.redes.unlp.edu.ar. 604800 IN	A	172.28.0.30
ns-sv-b.redes.unlp.edu.ar. 604800 IN	A	172.28.0.29

;; Query time: 3 msec
;; SERVER: 172.28.0.29#53(172.28.0.29)
;; WHEN: Tue Apr 15 16:32:20 -03 2025
;; MSG SIZE  rcvd: 150
```

Noto que cambia la COOKIE, esto se debe a que se están regenerando al hacer una nueva petición?
También veo que en ANSWER SECTION puede cambiar el orden de los NAME SERVERS.

SEGUN GEMINI:

```
1. COOKIE en la sección OPT PSEUDOSECTION:

Propósito del COOKIE: El COOKIE en la sección OPT PSEUDOSECTION está relacionado con un mecanismo de seguridad llamado DNS Cookies (RFC 7873). Su objetivo principal es proteger a los servidores DNS contra ataques de suplantación de identidad (spoofing).

Cómo funciona: Cuando un cliente DNS (como dig) envía una consulta con la opción EDNS (Extension Mechanisms for DNS), puede incluir una cookie de cliente. El servidor DNS, si soporta DNS Cookies, puede incluir una cookie de servidor en su respuesta. Esta cookie de servidor se deriva de la cookie del cliente y de información específica del servidor.

Cambios en cada consulta:

Cookie del cliente (en la consulta): Aunque dig puede enviar la misma cookie de cliente en múltiples consultas consecutivas desde la misma instancia, algunos sistemas operativos o versiones de dig podrían generar una cookie ligeramente diferente en cada consulta.
Cookie del servidor (en la respuesta): El servidor DNS genera la cookie del servidor basándose en la cookie del cliente y en información interna (que puede cambiar ligeramente entre respuestas, aunque no es lo más común). Incluso si la cookie del cliente es la misma, la implementación del servidor podría generar una cookie de servidor diferente por razones de seguridad o gestión de sesiones.
En resumen: La presencia y el valor del COOKIE pueden cambiar en cada consulta como parte del mecanismo de seguridad de DNS Cookies para prevenir la suplantación de identidad entre el cliente y el servidor DNS.
```

<b>e.</b> Observe la información que obtuvo al consultar por los servidores de DNS del dominio. En base a la salida, ¿es posible indicar cuál de ellos es el primario?

<b>f.</b> Consulte por el registro SOA del dominio y responda.
<b>i.</b> ¿Puede ahora determinar cuál es el servidor de DNS primario?
<b>ii.</b> ¿Cuál es el número de serie, qué convención sigue y en qué casos es importante actualizarlo?
<b>iii.</b> ¿Qué valor tiene el segundo campo del registro? Investigue para qué se usa y cómo se interpreta el valor.
<b>iv.</b> ¿Qué valor tiene el TTL de caché negativa y qué significa?

<b>g.</b> Indique qué valor tiene el registro TXT para el nombre ```saludo.redes.unlp.edu.ar```. Investigue para qué es usado este registro.

<b>h.</b> Utilizando dig, solicite la transferencia de zona de ```redes.unlp.edu.ar```, analice la salida y responda.
<b>i.</b> ¿Qué significan los números que aparecen antes de la palabra IN? ¿Cuál es su finalidad?
<b>ii.</b> ¿Cuántos registros NS observa? Compare la respuesta con los servidores de DNS del dominio ```redes.unlp.edu.ar``` que dio anteriormente. ¿Puede explicar a qué se debe la diferencia y qué significa?

<b>i.</b> Consulte por el registro A de ```www.redes.unlp.edu.ar``` y luego por el registro A de ```www.practica.redes.unlp.edu.ar```. Observe los TTL de ambos. Repita la operación y compare el valor de los TTL de cada uno respecto de la respuesta anterior. ¿Puede explicar qué está ocurriendo? (Pista: observar los flags será de ayuda).

<b>j.</b> Consulte por el registro A de ```www.practica2.redes.unlp.edu.ar```. ¿Obtuvo alguna respuesta? Investigue sobre los códigos de respuesta de DNS. ¿Para qué son utilizados los mensajes NXDOMAIN y NOERROR?